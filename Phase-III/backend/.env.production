# Task CRUD API - Production Environment Configuration
#
# IMPORTANT: Never commit this file with actual secrets to version control.
# Use environment variables or secure secret management (AWS Secrets Manager, etc.)

# ============================================================================
# DATABASE CONFIGURATION
# ============================================================================

# PostgreSQL connection string for production database
# Format: postgresql+asyncpg://username:password@host:port/database
#
# For Neon (serverless PostgreSQL):
# Get connection string from Neon dashboard, format as above
# Example: postgresql+asyncpg://user:password@neon.tech/database
DATABASE_URL=postgresql://neondb_owner:npg_gjzWEi0sPM8q@ep-wandering-frost-a7uxtoay-pooler.ap-southeast-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require

# Alternative for standard PostgreSQL:
# DATABASE_URL=postgresql+asyncpg://user:password@localhost:5432/task_api

# ============================================================================
# AUTHENTICATION & SECURITY
# ============================================================================

# JWT Secret for token signing
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
# MUST be at least 32 characters and cryptographically random
JWT_SECRET=your_very_long_random_secret_key_minimum_32_characters

# Better Auth Secret for authentication integration
# Generate with: python -c "import secrets; print(secrets.token_urlsafe(32))"
BETTER_AUTH_SECRET=VzC9WUWdHmNpP7b5B5SaMQfZS7cF9EEr

# ============================================================================
# LOGGING & MONITORING
# ============================================================================

# Log level (debug, info, warning, error, critical)
# Set to 'info' for production
LOG_LEVEL=info

# Debug mode (NEVER true in production)
# Set to 'false' for production
DEBUG=false

# ============================================================================
# DEPLOYMENT CONFIGURATION
# ============================================================================

# Application environment
ENVIRONMENT=production

# API host and port (typically 0.0.0.0:8000 when behind reverse proxy)
API_HOST=0.0.0.0
API_PORT=8000

# CORS configuration (restrict to your frontend domain)
# Set specific domains instead of "*" in production
CORS_ORIGINS=["https://yourdomain.com", "https://api.yourdomain.com"]

# ============================================================================
# OPENAI AGENTS SDK CONFIGURATION (Phase-III AI Chatbot)
# ============================================================================

# OpenAI API Key (https://platform.openai.com/api-keys)
# CRITICAL: Keep this secret! Never commit to version control.
# Use environment variable or secret management system in production.
# [Task]: T316, [From]: specs/004-ai-chatbot/spec.md#FR-008
OPENAI_API_KEY=sk-your-openai-api-key-here

# OpenAI Model selection
# Recommended: gpt-4-turbo-preview or later for multi-turn reasoning
# [Task]: T316, [From]: specs/004-ai-chatbot/plan.md#OpenAI-Only-AI-Stack
OPENAI_MODEL=gpt-4-turbo-preview

# Agent execution timeout (seconds)
# [Task]: T320, [From]: specs/004-ai-chatbot/spec.md#CLARIFICATION-001
AGENT_TIMEOUT=10

# Token context window limit for agent
# Typically 8000 tokens max; 20-message history â‰ˆ 2-3K tokens
# [Task]: T321, [From]: specs/004-ai-chatbot/plan.md#Decision-4-Token-Window
AGENT_MAX_MESSAGES=20

# ============================================================================
# RATE LIMITING (Optional - if implementing)
# ============================================================================

# Rate limit requests per minute per IP
RATE_LIMIT_PER_MINUTE=60

# ============================================================================
# MONITORING & OBSERVABILITY (Optional)
# ============================================================================

# Sentry error tracking (optional)
# SENTRY_DSN=https://key@sentry.io/project

# DataDog APM (optional)
# DATADOG_API_KEY=your-datadog-key

# ============================================================================
# DEPLOYMENT NOTES
# ============================================================================
#
# 1. SECURITY CHECKLIST:
#    - JWT_SECRET: Use strong random value (min 32 chars)
#    - BETTER_AUTH_SECRET: Use strong random value (min 32 chars)
#    - DEBUG: Must be false
#    - DATABASE_URL: Use secure connection (postgresql+asyncpg)
#    - CORS_ORIGINS: Restrict to specific domains
#    - Use HTTPS only
#    - Enable database backups
#    - Monitor error rates
#    - Keep dependencies updated
#
# 2. PERFORMANCE TUNING:
#    - Use connection pooling (default SQLAlchemy pooling)
#    - Enable database query caching where appropriate
#    - Use CDN for static assets (if applicable)
#    - Configure proper timeouts (60s for HTTP, 5s for DB)
#    - Monitor response times (target <500ms p95)
#
# 3. DATABASE SETUP:
#    - PostgreSQL version: 12+ recommended
#    - Enable SSL/TLS for connections
#    - Configure automatic backups
#    - Monitor disk usage and query performance
#    - Use appropriate indexes
#
# 4. DEPLOYMENT:
#    - Use Docker or native Python with gunicorn
#    - Minimum 2+ worker processes
#    - Health checks on /health endpoint
#    - Graceful shutdown (30s timeout)
#    - Rolling deployments for zero downtime
#
# 5. MONITORING:
#    - Log all errors with correlation IDs
#    - Monitor API latency (target <500ms p95)
#    - Alert on error rate >1%
#    - Monitor database connection pool
#    - Track JWT token generation/validation rates
#
# Example Docker Compose for production:
#
# version: '3.8'
# services:
#   api:
#     image: task-api:latest
#     ports:
#       - "8000:8000"
#     environment:
#       DATABASE_URL: postgresql+asyncpg://user:pass@postgres:5432/task_api
#       JWT_SECRET: ${JWT_SECRET}
#       BETTER_AUTH_SECRET: ${BETTER_AUTH_SECRET}
#       LOG_LEVEL: info
#       DEBUG: 'false'
#     depends_on:
#       - postgres
#     healthcheck:
#       test: ["CMD", "curl", "-f", "http://localhost:8000/health"]
#       interval: 30s
#       timeout: 10s
#       retries: 3
#     restart: always
#
#   postgres:
#     image: postgres:15-alpine
#     environment:
#       POSTGRES_DB: task_api
#       POSTGRES_USER: postgres
#       POSTGRES_PASSWORD: ${DB_PASSWORD}
#     volumes:
#       - postgres_data:/var/lib/postgresql/data
#     healthcheck:
#       test: ["CMD-SHELL", "pg_isready -U postgres"]
#       interval: 10s
#       timeout: 5s
#       retries: 5
#     restart: always
#
# volumes:
#   postgres_data:
#
# ============================================================================
